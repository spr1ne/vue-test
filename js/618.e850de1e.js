"use strict";(self["webpackChunkcft_test"]=self["webpackChunkcft_test"]||[]).push([[618],{9618:function(e,t,o){o.r(t),o.d(t,{default:function(){return P}});var n=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{ref:"rootEl",staticClass:"builder-col",class:{"builder-col_column":!e.col.component&&e.col.rows&&e.col.rows.length},on:{click:e.onClick,keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onClick.apply(null,arguments)}}},[e.col.isFilled?e._e():t("span",{staticClass:"builder-col__empty"},[e._v("+")]),e.col.component?[t("builder-col-component",{attrs:{row:e.row,col:e.col}})]:e._l(e.col.rows,(function(e){return t("builder-row",{key:e.id,attrs:{rowId:e.id}})})),e.isRendered?t("ui-menu",{attrs:{rootEl:e.rootEl,options:e.menuOptions},on:{onInit:e.onMenuInit,onSelect:e.onSelect}}):e._e()],2)},i=[],s=o(2473),l=(o(4114),o(1558),o(6456)),r=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{ref:"rootEl",staticClass:"builder-col-component",on:{click:e.onClick,keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onClick.apply(null,arguments)}}},[e._v(" "+e._s(this.col.component.name)+" "+e._s(e.id)+" "+e._s(e.title)+" "+e._s(e.name)+" "),e._l(e.col.rows,(function(e){return t("builder-row",{key:e.id,attrs:{rowId:e.id}})})),e.isRendered?t("ui-menu",{attrs:{rootEl:e.rootEl,options:e.menuOptions},on:{onInit:e.onMenuInit,onSelect:e.onSelect}}):e._e()],2)},u=[],c=function(){var e=this,t=e._self._c;e._self._setupProxy;return e.isMenuOpen?t("div",{staticClass:"menu",style:{left:e.menuPosition.x+"px",top:e.menuPosition.y+"px"}},e._l(e.options,(function(o){return t("div",{key:o.id,staticClass:"menu__option",on:{click:function(t){return t.stopPropagation(),e.onSelect(o)},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSelect(o)}}},[e._v(" "+e._s(o.name)+" ")])})),0):e._e()},d=[],p=o(7256),a=o(2107);let h=class extends a.lD{constructor(...e){super(...e),(0,s.A)(this,"rootEl",void 0),(0,s.A)(this,"options",void 0),(0,s.A)(this,"isMenuOpen",!1),(0,s.A)(this,"menuPosition",{x:0,y:0})}onInit(){const e={open:this.open.bind(this)};return e}onSelect(e){this.close()}handleClickOutside(e){const t=e?.target;t&&this.rootEl&&t!==this.rootEl&&(this.isMenuOpen=!1)}mounted(){document.addEventListener("click",this.handleClickOutside.bind(this)),this.onInit()}beforeDestroy(){document.removeEventListener("click",this.handleClickOutside.bind(this))}open(e){this.menuPosition.x=e.offsetX,this.menuPosition.y=e.offsetY,this.isMenuOpen=!0}close(){this.isMenuOpen=!1}};(0,l.Cg)([(0,a.O5)("onInit")],h.prototype,"onInit",null),(0,l.Cg)([(0,a.O5)("onSelect")],h.prototype,"onSelect",null),(0,l.Cg)([(0,a.kv)()],h.prototype,"rootEl",void 0),(0,l.Cg)([(0,a.kv)()],h.prototype,"options",void 0),h=(0,l.Cg)([(0,p.Ay)({name:"ui-menu"})],h);var m=h,v=m,y=o(1656),f=(0,y.A)(v,c,d,!1,null,null,null),C=f.exports,k=o(6118),w=o(2988),_=o(2942);let A=class extends a.lD{constructor(...e){super(...e),(0,s.A)(this,"row",void 0),(0,s.A)(this,"col",void 0),(0,s.A)(this,"rootEl",void 0),(0,s.A)(this,"isRendered",!1),(0,s.A)(this,"menuApi",void 0)}get menuOptions(){const e=[{id:1,name:"Строка",value:"row"},{id:4,name:"Настроить компонент",value:"settings"}];return e}get settings(){return this.col.component.props.settings}get id(){const e=this.settings.find((e=>"id"===e.name));return e?`id=(${e.value})`:""}get title(){const e=this.settings.find((e=>"title"===e.name));return e?`(title=${e.value})`:""}get name(){const e=this.settings.find((e=>"name"===e.name));return e?`(name=${e.value})`:""}mounted(){this.isRendered=!0}onClick(e){this.menuApi.open(e)}onMenuInit(e){this.menuApi=e}onSelect(e){if("row"===e.value){const e=(0,_.yC)(w.A),t=e.save({colId:this.col.id,cols:[]});(0,_.yC)(k.A).save({rowId:t.id,componentName:"",rows:[]})}else"settings"===e.value&&this.$router.push({name:"colEdit",params:{colId:this.col.id}}).then((()=>{this.$router.push({name:"componentEdit",params:{componentId:this.col.componentId}})}))}};(0,l.Cg)([(0,a.kv)()],A.prototype,"row",void 0),(0,l.Cg)([(0,a.kv)()],A.prototype,"col",void 0),(0,l.Cg)([(0,a.oS)("rootEl")],A.prototype,"rootEl",void 0),A=(0,l.Cg)([(0,p.Ay)({name:"builder-col",components:{BuilderRow:()=>Promise.resolve().then(o.bind(o,9339)),UiMenu:C}})],A);var g=A,E=g,I=(0,y.A)(E,r,u,!1,null,null,null),b=I.exports;let x=class extends a.lD{constructor(...e){super(...e),(0,s.A)(this,"fdbEventBus",void 0),(0,s.A)(this,"row",void 0),(0,s.A)(this,"colId",void 0),(0,s.A)(this,"rootEl",void 0),(0,s.A)(this,"isRendered",!1),(0,s.A)(this,"menuApi",void 0)}get col(){return(0,_.yC)(k.A).with("rows").with("component").find(this.colId)||new k.A}get menuOptions(){const e=[{id:2,name:"Колонка",value:"col"},{id:3,name:"Компонент",value:"component"},{id:4,name:"Настроить",value:"col-settings"},{id:5,name:"Удалить",value:"delete"}];return this.col.component||e.push({id:1,name:"Строка",value:"row"}),e}mounted(){this.isRendered=!0}onClick(e){this.menuApi.open(e)}onMenuInit(e){this.menuApi=e}onSelect(e){if("row"===e.value){const e=(0,_.yC)(w.A),t=e.save({colId:this.col.id,cols:[]});(0,_.yC)(k.A).save({rowId:t.id,rows:[]})}else"col"===e.value?((0,_.yC)(k.A).save({rowId:this.row.id,rows:[]}),this.fdbEventBus.$emit("update-form")):"col-settings"===e.value?this.$router.push({name:"colEdit",params:{colId:this.col.id}}):"component"===e.value?this.$router.push({name:"colEdit",params:{colId:this.col.id}}).then((()=>{this.$router.push({name:"componentNew"})})):"delete"===e.value&&((0,_.yC)(k.A).destroy(this.col.id),1===this.row.cols.length&&(0,_.yC)(w.A).destroy(this.row.id))}};(0,l.Cg)([(0,a.y_)("fdb-event-bus")],x.prototype,"fdbEventBus",void 0),(0,l.Cg)([(0,a.kv)()],x.prototype,"row",void 0),(0,l.Cg)([(0,a.kv)()],x.prototype,"colId",void 0),(0,l.Cg)([(0,a.oS)("rootEl")],x.prototype,"rootEl",void 0),x=(0,l.Cg)([(0,p.Ay)({name:"builder-col",components:{UiMenu:C,BuilderRow:()=>Promise.resolve().then(o.bind(o,9339)),BuilderColComponent:b}})],x);var O=x,S=O,M=(0,y.A)(S,n,i,!1,null,null,null),P=M.exports}}]);
//# sourceMappingURL=618.e850de1e.js.map