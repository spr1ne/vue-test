"use strict";(self["webpackChunkcft_test"]=self["webpackChunkcft_test"]||[]).push([[798],{798:function(t,e,o){o.r(e),o.d(e,{default:function(){return V}});var i=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"col",class:t.col.size},[t.col.component?[e(t.col.component.name,t._g(t._b({tag:"component"},"component",{row:t.row,col:t.col,formId:t.formId,value:t.value,...t.col.component.props},!1),{onInput:t.onInput}),t._l(t.col.rows,(function(o){return e("dynamic-row",{key:o.id,attrs:{formId:t.formId,rowId:o.id}})})),1)]:t.col.rows&&t.col.rows.length?t._l(t.col.rows,(function(o){return e("dynamic-row",{key:o.id,attrs:{formId:t.formId,rowId:o.id}})})):t._e()],2)},n=[],s=o(2473),r=(o(1558),o(6456)),l=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("button",{staticClass:"button",attrs:{type:t.type},on:{click:t.onClick}},[t._v(" "+t._s(t.title)+" ")])},d=[],c=o(7256),a=o(2107);let u=class extends a.lD{constructor(...t){super(...t),(0,s.A)(this,"dynamicFormBus",void 0),(0,s.A)(this,"settings",void 0)}onClick(t){this.event&&this.dynamicFormBus.$emit(this.event)}get type(){const t=this.settings.find((t=>"type"===t.name));return t.value}get title(){const t=this.settings.find((t=>"title"===t.name));return t.value}get event(){const t=this.settings.find((t=>"event"===t.name));return t.value}};(0,r.Cg)([(0,a.y_)("dynamic-form-bus")],u.prototype,"dynamicFormBus",void 0),(0,r.Cg)([(0,a.O5)("click")],u.prototype,"onClick",null),(0,r.Cg)([(0,a.kv)()],u.prototype,"settings",void 0),u=(0,r.Cg)([c.Ay],u);var v=u,p=v,m=o(1656),f=(0,m.A)(p,l,d,!1,null,"60c1078e",null),h=f.exports,y=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("form",{attrs:{name:t.name},on:{submit:function(t){t.preventDefault()}}},[t._v(" "+t._s(t.$log(JSON.stringify(t.form)))+" "),t._t("default")],2)},g=[],C=o(6118),I=o(6116),_=o(2942),A=o(7497);class w extends _.Kx{}(0,s.A)(w,"entity","formData"),(0,s.A)(w,"piniaOptions",{persist:!0}),(0,r.Cg)([(0,A.nx)()],w.prototype,"id",void 0),(0,r.Cg)([(0,A.Mx)("")],w.prototype,"value",void 0),(0,r.Cg)([(0,A.Mx)("")],w.prototype,"form_id",void 0);var k=o(2988);let x=class extends a.lD{constructor(...t){super(...t),(0,s.A)(this,"dynamicFormBus",new a.lD),(0,s.A)(this,"col",void 0),(0,s.A)(this,"formId",void 0),(0,s.A)(this,"settings",void 0)}get form(){return(0,_.yC)(I.A).withAllRecursive(2).find(this.formId)}get name(){const t=this.settings.find((t=>"name"===t.name));return t.value}created(){this.dynamicFormBus.$on("clear",this.clearForm)}beforeDestroy(){this.dynamicFormBus.$off("clear",this.clearForm)}clearForm(){this.col.entityId&&(0,_.yC)(w).where("id",this.col.entityId).update({value:""}),this.clear(this.col.rows)}clear(t){t.forEach((t=>{const e=(0,_.yC)(k.A).with("cols").find(t.id);e&&e.cols&&e.cols.forEach((t=>{t.entityId&&(0,_.yC)(w).where("id",t.entityId).update({value:""});const e=(0,_.yC)(C.A).with("rows").find(t.id);e&&e.rows&&this.clear(e.rows)}))}))}};(0,r.Cg)([(0,a.ku)("dynamic-form-bus")],x.prototype,"dynamicFormBus",void 0),(0,r.Cg)([(0,a.kv)()],x.prototype,"col",void 0),(0,r.Cg)([(0,a.kv)()],x.prototype,"formId",void 0),(0,r.Cg)([(0,a.kv)()],x.prototype,"settings",void 0),x=(0,r.Cg)([c.Ay],x);var D=x,b=D,F=(0,m.A)(b,y,g,!1,null,null,null),B=F.exports,E=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("label",{staticClass:"label",attrs:{for:t.id}},[e("div",{staticClass:"label__text"},[t._v(t._s(t.title))]),t._t("default")],2)},P=[];let M=class extends a.lD{constructor(...t){super(...t),(0,s.A)(this,"settings",void 0)}get id(){const t=this.settings.find((t=>"id"===t.name));return t.value}get title(){const t=this.settings.find((t=>"title"===t.name));return t.value}};(0,r.Cg)([(0,a.kv)()],M.prototype,"settings",void 0),M=(0,r.Cg)([c.Ay],M);var q=M,O=q,$=(0,m.A)(O,E,P,!1,null,"78c6a73e",null),R=$.exports,S=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",[e("input",{ref:"inputElement",staticClass:"input",attrs:{id:t.id,type:"text",autocomplete:"off",placeholder:t.placeholder,required:t.required},domProps:{value:t.value},on:{input:t.onInput,invalid:t.onInvalid}}),t.isInvalid?e("UiError",{attrs:{error:t.errorMsg}}):t._e()],1)},U=[],z=o(3673);let J=class extends a.lD{constructor(...t){super(...t),(0,s.A)(this,"row",void 0),(0,s.A)(this,"col",void 0),(0,s.A)(this,"value",void 0),(0,s.A)(this,"formId",void 0),(0,s.A)(this,"settings",void 0),(0,s.A)(this,"inputElement",void 0),(0,s.A)(this,"isInvalid",!1),(0,s.A)(this,"errorMsg","")}onInput(t){this.isInvalid=!1}get id(){const t=this.settings.find((t=>"id"===t.name));return t.value}get placeholder(){const t=this.settings.find((t=>"placeholder"===t.name));return t.value}get required(){const t=this.settings.find((t=>"required"===t.name));return t.value}onInvalid(t){this.isInvalid=!0,this.errorMsg="Поле не должно быть пустым",t.preventDefault()}};(0,r.Cg)([(0,a.O5)("onInput")],J.prototype,"onInput",null),(0,r.Cg)([(0,a.kv)()],J.prototype,"row",void 0),(0,r.Cg)([(0,a.kv)()],J.prototype,"col",void 0),(0,r.Cg)([(0,a.kv)()],J.prototype,"value",void 0),(0,r.Cg)([(0,a.kv)()],J.prototype,"formId",void 0),(0,r.Cg)([(0,a.kv)()],J.prototype,"settings",void 0),(0,r.Cg)([(0,a.oS)("inputElement")],J.prototype,"inputElement",void 0),J=(0,r.Cg)([(0,c.Ay)({components:{UiError:z.A}})],J);var K=J,L=K,N=(0,m.A)(L,S,U,!1,null,"2ab99678",null),T=N.exports;let j=class extends a.lD{constructor(...t){super(...t),(0,s.A)(this,"row",void 0),(0,s.A)(this,"colId",void 0),(0,s.A)(this,"formId",void 0)}get col(){return(0,_.yC)(C.A).with("row").with("rows").with("component").find(this.colId)||new C.A}get entityData(){if(this.col.entityId){const t=(0,_.yC)(w),e=t.find(this.col.entityId);if(e)return e}return new w}get value(){return this.col.component.name?this.entityData.value:null}onInput(t){const e=t?.target,{value:o}=e,i=(0,_.yC)(w);if(this.col.entityId){const t=i.find(this.col.entityId);t&&i.where("id",this.col.entityId).update({...t,value:o})}else{const t=i.save({form_id:this.formId,value:o});t&&(this.col.entityId=t.id,(0,_.yC)(C.A).save(this.col))}}};(0,r.Cg)([(0,a.kv)()],j.prototype,"row",void 0),(0,r.Cg)([(0,a.kv)()],j.prototype,"colId",void 0),(0,r.Cg)([(0,a.kv)()],j.prototype,"formId",void 0),j=(0,r.Cg)([(0,c.Ay)({components:{DynamicRow:()=>Promise.resolve().then(o.bind(o,4873)),DynamicLabel:R,DynamicText:T,DynamicForm:B,DynamicButton:h}})],j);var G=j,H=G,Q=(0,m.A)(H,i,n,!1,null,null,null),V=Q.exports}}]);
//# sourceMappingURL=798.57a9a0e7.js.map